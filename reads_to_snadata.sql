-- Join forum read data against post data to extract reads in the SNA form of:
-- Reader -> Poster (The person reading is the source, the person who posted is the target)
SELECT * INTO mdl_forum_read_scrubbed_snadata FROM (SELECT p.id AS postid, r.userid AS user_reader, p.userid AS user_poster, r.firstread, r.lastread FROM mdl_forum_read r JOIN mdl_forum_posts p ON r.postid = p.id ORDER BY postid, firstread) data;


-- Data Example, first 50 lines:
-- SELECT p.id AS postid, r.userid AS user_reader, p.userid AS user_poster, r.firstread, r.lastread FROM mdl_forum_read r JOIN mdl_forum_posts p ON r.postid = p.id ORDER BY postid, firstread LIMIT 50;
--
--  postid | user_reader | user_poster | firstread  |  lastread  
-- --------+-------------+-------------+------------+------------
--  732280 |      345741 |       28974 | 1411192277 | 1411192277
--  732280 |      349107 |       28974 | 1411192660 | 1411192660
--  732280 |      357348 |       28974 | 1411192694 | 1411192694
--  732280 |      354054 |       28974 | 1411192863 | 1411192863
--  732280 |      346338 |       28974 | 1411193088 | 1411193088
--  732280 |      251250 |       28974 | 1411193196 | 1411193196
--  732280 |      353244 |       28974 | 1411193207 | 1411193207
--  732280 |      348312 |       28974 | 1411194104 | 1411194104
--  732280 |      334050 |       28974 | 1411194127 | 1411194127
--  732280 |      345540 |       28974 | 1411194238 | 1411194238
--  732280 |      344418 |       28974 | 1411194769 | 1411194769
--  732280 |      376068 |       28974 | 1411194947 | 1411194947
--  732280 |      349671 |       28974 | 1411196412 | 1411196412
--  732280 |      348396 |       28974 | 1411197481 | 1411197481
--  732280 |      343635 |       28974 | 1411197589 | 1411197589
--  732280 |      344397 |       28974 | 1411198952 | 1411198952
--  732280 |      360837 |       28974 | 1411199928 | 1411199928
--  732280 |      350661 |       28974 | 1411200165 | 1411200165
--  732280 |      354933 |       28974 | 1411201481 | 1411201481
--  732280 |      346104 |       28974 | 1411202613 | 1411202613
--  732280 |      334614 |       28974 | 1411203079 | 1411203079
--  732280 |      346407 |       28974 | 1411203330 | 1411203330
--  732280 |      345051 |       28974 | 1411204734 | 1411204734
--  732280 |      355620 |       28974 | 1411205398 | 1411205398
--  732280 |      361182 |       28974 | 1411205782 | 1411205782
--  732280 |      344241 |       28974 | 1411205846 | 1411205846
--  732280 |      335139 |       28974 | 1411208158 | 1411208158
--  732280 |      361854 |       28974 | 1411211602 | 1411211602
--  732280 |      362157 |       28974 | 1411212855 | 1411212855
--  732280 |      337680 |       28974 | 1411212984 | 1411212984
--  732280 |      366462 |       28974 | 1411214320 | 1411214320
--  732280 |      353481 |       28974 | 1411214499 | 1411214499
--  732280 |      349791 |       28974 | 1411216019 | 1411216019
--  732280 |      334935 |       28974 | 1411216606 | 1411216606
--  732280 |      352929 |       28974 | 1411217386 | 1411217386
--  732280 |      335244 |       28974 | 1411218456 | 1411218456
--  732280 |      333252 |       28974 | 1411223985 | 1411223985
--  732280 |      355797 |       28974 | 1411225591 | 1411225591
--  732280 |      360900 |       28974 | 1411229745 | 1411229745
--  732280 |      350682 |       28974 | 1411247611 | 1411247611
--  732280 |      190812 |       28974 | 1411253170 | 1411253170
--  732280 |      351144 |       28974 | 1411255022 | 1411255022
--  732280 |      362979 |       28974 | 1411256647 | 1411256647
--  732280 |      250581 |       28974 | 1411259472 | 1411259472
--  732280 |      352890 |       28974 | 1411259867 | 1411259867
--  732280 |      354312 |       28974 | 1411261844 | 1411261844
--  732280 |      345864 |       28974 | 1411261860 | 1411261860
--  732280 |      355161 |       28974 | 1411263123 | 1411263123
--  732280 |      353202 |       28974 | 1411263456 | 1411263456
--  732280 |      349917 |       28974 | 1411268216 | 1411268216
-- (50 rows)


